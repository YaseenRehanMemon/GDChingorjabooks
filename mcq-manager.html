<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MCQ Manager - Our Books</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .card-hover {
            transition: all 0.3s ease;
        }
        .card-hover:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }
        .json-editor {
            font-family: 'Courier New', monospace;
            background: #1e1e1e;
            color: #d4d4d4;
        }
        .success-animation {
            animation: successPulse 0.6s ease-in-out;
        }
        @keyframes successPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Header -->
    <header class="gradient-bg text-white py-6">
        <div class="container mx-auto px-4">
            <div class="flex items-center justify-between">
                <div>
                    <h1 class="text-3xl font-bold">MCQ Manager</h1>
                    <p class="text-blue-100 mt-2">Create and manage Multiple Choice Questions for all subjects</p>
                </div>
                <div class="flex items-center space-x-4">
                    <i class="fas fa-brain text-4xl text-blue-200"></i>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <div class="container mx-auto px-4 py-8">
        <!-- Subject Selection -->
        <div class="mb-8">
            <h2 class="text-2xl font-bold text-gray-800 mb-4">Select Subject & Class</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                <div class="subject-card bg-white rounded-lg p-6 card-hover cursor-pointer" data-subject="chemistry" data-class="xi">
                    <div class="text-center">
                        <i class="fas fa-flask text-4xl text-green-600 mb-3"></i>
                        <h3 class="text-lg font-semibold text-gray-800">Chemistry XI</h3>
                        <p class="text-sm text-gray-600">12 Chapters</p>
                    </div>
                </div>
                <div class="subject-card bg-white rounded-lg p-6 card-hover cursor-pointer" data-subject="chemistry" data-class="xii">
                    <div class="text-center">
                        <i class="fas fa-flask text-4xl text-green-600 mb-3"></i>
                        <h3 class="text-lg font-semibold text-gray-800">Chemistry XII</h3>
                        <p class="text-sm text-gray-600">13 Chapters</p>
                    </div>
                </div>
                <div class="subject-card bg-white rounded-lg p-6 card-hover cursor-pointer" data-subject="physics" data-class="xi">
                    <div class="text-center">
                        <i class="fas fa-atom text-4xl text-blue-600 mb-3"></i>
                        <h3 class="text-lg font-semibold text-gray-800">Physics XI</h3>
                        <p class="text-sm text-gray-600">14 Chapters</p>
                    </div>
                </div>
                <div class="subject-card bg-white rounded-lg p-6 card-hover cursor-pointer" data-subject="physics" data-class="xii">
                    <div class="text-center">
                        <i class="fas fa-atom text-4xl text-blue-600 mb-3"></i>
                        <h3 class="text-lg font-semibold text-gray-800">Physics XII</h3>
                        <p class="text-sm text-gray-600">14 Chapters</p>
                    </div>
                </div>
                <div class="subject-card bg-white rounded-lg p-6 card-hover cursor-pointer" data-subject="math" data-class="xi">
                    <div class="text-center">
                        <i class="fas fa-calculator text-4xl text-purple-600 mb-3"></i>
                        <h3 class="text-lg font-semibold text-gray-800">Math XI</h3>
                        <p class="text-sm text-gray-600">12 Chapters</p>
                    </div>
                </div>
                <div class="subject-card bg-white rounded-lg p-6 card-hover cursor-pointer" data-subject="math" data-class="xii">
                    <div class="text-center">
                        <i class="fas fa-calculator text-4xl text-purple-600 mb-3"></i>
                        <h3 class="text-lg font-semibold text-gray-800">Math XII</h3>
                        <p class="text-sm text-gray-600">12 Chapters</p>
                    </div>
                </div>
                <div class="subject-card bg-white rounded-lg p-6 card-hover cursor-pointer" data-subject="biology" data-class="xi">
                    <div class="text-center">
                        <i class="fas fa-dna text-4xl text-red-600 mb-3"></i>
                        <h3 class="text-lg font-semibold text-gray-800">Biology XI</h3>
                        <p class="text-sm text-gray-600">14 Chapters</p>
                    </div>
                </div>
                <div class="subject-card bg-white rounded-lg p-6 card-hover cursor-pointer" data-subject="biology" data-class="xii">
                    <div class="text-center">
                        <i class="fas fa-dna text-4xl text-red-600 mb-3"></i>
                        <h3 class="text-lg font-semibold text-gray-800">Biology XII</h3>
                        <p class="text-sm text-gray-600">13 Chapters</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Chapter Selection -->
        <div id="chapter-selection" class="mb-8 hidden">
            <h2 class="text-2xl font-bold text-gray-800 mb-4">Select Chapter</h2>
            <div id="chapters-grid" class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3">
                <!-- Chapters will be populated dynamically -->
            </div>
        </div>

        <!-- MCQ Creation Form -->
        <div id="mcq-form" class="hidden">
            <div class="bg-white rounded-lg shadow-lg p-6">
                <div class="flex items-center justify-between mb-6">
                    <h2 class="text-2xl font-bold text-gray-800">Create MCQ File</h2>
                    <div id="selected-chapter-info" class="text-sm text-gray-600"></div>
                </div>

                <!-- JSON Input -->
                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        Paste MCQ JSON Data Here
                    </label>
                    <div class="relative">
                        <textarea 
                            id="mcq-json-input" 
                            class="w-full h-96 p-4 border border-gray-300 rounded-lg json-editor resize-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                            placeholder="Paste your MCQ JSON data here..."
                        ></textarea>
                        <div class="absolute top-2 right-2">
                            <button id="format-json" class="bg-gray-600 text-white px-3 py-1 rounded text-sm hover:bg-gray-700">
                                <i class="fas fa-code mr-1"></i>Format
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Validation Status -->
                <div id="validation-status" class="mb-4 hidden">
                    <div class="flex items-center space-x-2">
                        <i id="validation-icon" class="fas fa-check-circle text-green-500"></i>
                        <span id="validation-message" class="text-sm text-gray-600"></span>
                    </div>
                </div>

                <!-- Preview -->
                <div id="mcq-preview" class="mb-6 hidden">
                    <h3 class="text-lg font-semibold text-gray-800 mb-3">Preview</h3>
                    <div id="preview-content" class="bg-gray-50 p-4 rounded-lg max-h-64 overflow-y-auto">
                        <!-- Preview content will be populated here -->
                    </div>
                </div>

                <!-- Actions -->
                <div class="flex space-x-4">
                    <button id="create-mcq-file" class="bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed">
                        <i class="fas fa-save mr-2"></i>Create MCQ File
                    </button>
                    <button id="preview-mcqs" class="bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors">
                        <i class="fas fa-eye mr-2"></i>Preview MCQs
                    </button>
                    <button id="clear-form" class="bg-gray-600 text-white px-6 py-3 rounded-lg hover:bg-gray-700 transition-colors">
                        <i class="fas fa-trash mr-2"></i>Clear
                    </button>
                </div>
            </div>
        </div>

        <!-- Success Message -->
        <div id="success-message" class="hidden fixed top-4 right-4 bg-green-500 text-white p-4 rounded-lg shadow-lg z-50">
            <div class="flex items-center space-x-2">
                <i class="fas fa-check-circle"></i>
                <span>MCQ file created successfully!</span>
            </div>
        </div>
    </div>

    <script>
        class MCQManager {
            constructor() {
                this.selectedSubject = null;
                this.selectedClass = null;
                this.selectedChapter = null;
                this.chapterData = {
                    chemistry: { xi: 12, xii: 13 },
                    physics: { xi: 14, xii: 14 },
                    math: { xi: 12, xii: 12 },
                    biology: { xi: 14, xii: 13 }
                };
                this.init();
            }

            init() {
                this.bindEvents();
            }

            bindEvents() {
                // Subject selection
                document.querySelectorAll('.subject-card').forEach(card => {
                    card.addEventListener('click', (e) => {
                        this.selectSubject(e.currentTarget.dataset.subject, e.currentTarget.dataset.class);
                    });
                });

                // JSON formatting
                document.getElementById('format-json').addEventListener('click', () => {
                    this.formatJSON();
                });

                // Preview MCQs
                document.getElementById('preview-mcqs').addEventListener('click', () => {
                    this.previewMCQs();
                });

                // Create MCQ file
                document.getElementById('create-mcq-file').addEventListener('click', () => {
                    this.createMCQFile();
                });

                // Clear form
                document.getElementById('clear-form').addEventListener('click', () => {
                    this.clearForm();
                });

                // JSON input validation
                document.getElementById('mcq-json-input').addEventListener('input', () => {
                    this.validateJSON();
                });
            }

            selectSubject(subject, classLevel) {
                this.selectedSubject = subject;
                this.selectedClass = classLevel;
                
                // Hide previous selections
                document.querySelectorAll('.subject-card').forEach(card => {
                    card.classList.remove('ring-2', 'ring-blue-500');
                });

                // Highlight selected
                document.querySelector(`[data-subject="${subject}"][data-class="${classLevel}"]`).classList.add('ring-2', 'ring-blue-500');

                // Show chapter selection
                this.showChapterSelection();
            }

            showChapterSelection() {
                const chapterSelection = document.getElementById('chapter-selection');
                const chaptersGrid = document.getElementById('chapters-grid');
                
                chaptersGrid.innerHTML = '';
                
                const totalChapters = this.chapterData[this.selectedSubject][this.selectedClass];
                
                for (let i = 1; i <= totalChapters; i++) {
                    const chapterCard = document.createElement('div');
                    chapterCard.className = 'bg-white rounded-lg p-4 card-hover cursor-pointer border border-gray-200 hover:border-blue-500';
                    chapterCard.innerHTML = `
                        <div class="text-center">
                            <div class="text-2xl font-bold text-gray-800 mb-1">${i}</div>
                            <div class="text-sm text-gray-600">Chapter ${i}</div>
                        </div>
                    `;
                    
                    chapterCard.addEventListener('click', () => {
                        this.selectChapter(i);
                    });
                    
                    chaptersGrid.appendChild(chapterCard);
                }
                
                chapterSelection.classList.remove('hidden');
            }

            selectChapter(chapterNumber) {
                this.selectedChapter = chapterNumber;
                
                // Remove previous selection
                document.querySelectorAll('#chapters-grid > div').forEach(card => {
                    card.classList.remove('ring-2', 'ring-blue-500', 'bg-blue-50');
                });

                // Highlight selected
                event.currentTarget.classList.add('ring-2', 'ring-blue-500', 'bg-blue-50');

                // Show MCQ form
                this.showMCQForm();
            }

            showMCQForm() {
                const mcqForm = document.getElementById('mcq-form');
                const selectedInfo = document.getElementById('selected-chapter-info');
                
                selectedInfo.textContent = `${this.selectedSubject.toUpperCase()} ${this.selectedClass.toUpperCase()} - Chapter ${this.selectedChapter}`;
                mcqForm.classList.remove('hidden');
                
                // Scroll to form
                mcqForm.scrollIntoView({ behavior: 'smooth' });
            }

            formatJSON() {
                const textarea = document.getElementById('mcq-json-input');
                try {
                    const jsonData = JSON.parse(textarea.value);
                    textarea.value = JSON.stringify(jsonData, null, 2);
                    this.showValidationStatus('success', 'JSON formatted successfully!');
                } catch (error) {
                    this.showValidationStatus('error', 'Invalid JSON format');
                }
            }

            validateJSON() {
                const textarea = document.getElementById('mcq-json-input');
                const value = textarea.value.trim();
                
                if (!value) {
                    this.hideValidationStatus();
                    return;
                }

                try {
                    const jsonData = JSON.parse(value);
                    
                    if (Array.isArray(jsonData)) {
                        this.showValidationStatus('success', `Valid JSON array with ${jsonData.length} MCQs`);
                        document.getElementById('create-mcq-file').disabled = false;
                    } else {
                        this.showValidationStatus('error', 'JSON must be an array of MCQs');
                        document.getElementById('create-mcq-file').disabled = true;
                    }
                } catch (error) {
                    this.showValidationStatus('error', 'Invalid JSON format');
                    document.getElementById('create-mcq-file').disabled = true;
                }
            }

            showValidationStatus(type, message) {
                const status = document.getElementById('validation-status');
                const icon = document.getElementById('validation-icon');
                const messageEl = document.getElementById('validation-message');
                
                status.classList.remove('hidden');
                icon.className = type === 'success' ? 'fas fa-check-circle text-green-500' : 'fas fa-exclamation-circle text-red-500';
                messageEl.textContent = message;
            }

            hideValidationStatus() {
                document.getElementById('validation-status').classList.add('hidden');
            }

            previewMCQs() {
                const textarea = document.getElementById('mcq-json-input');
                const value = textarea.value.trim();
                
                if (!value) {
                    alert('Please enter MCQ data first');
                    return;
                }

                try {
                    const mcqs = JSON.parse(value);
                    if (!Array.isArray(mcqs)) {
                        alert('JSON must be an array of MCQs');
                        return;
                    }

                    this.showPreview(mcqs.slice(0, 3)); // Show first 3 MCQs
                } catch (error) {
                    alert('Invalid JSON format');
                }
            }

            showPreview(mcqs) {
                const preview = document.getElementById('mcq-preview');
                const content = document.getElementById('preview-content');
                
                let html = '';
                mcqs.forEach((mcq, index) => {
                    html += `
                        <div class="mb-4 p-3 bg-white rounded border">
                            <div class="font-semibold text-gray-800 mb-2">${index + 1}. ${mcq.question}</div>
                            <div class="space-y-1 text-sm">
                                ${Object.entries(mcq.options || {}).map(([key, value]) => 
                                    `<div class="flex items-center space-x-2">
                                        <span class="font-medium">${key}:</span>
                                        <span class="${key === mcq.correct_answer ? 'text-green-600 font-semibold' : 'text-gray-600'}">${value}</span>
                                    </div>`
                                ).join('')}
                            </div>
                            <div class="text-xs text-gray-500 mt-2">
                                Difficulty: ${mcq.difficulty} | Topic: ${mcq.topic}
                            </div>
                        </div>
                    `;
                });
                
                content.innerHTML = html;
                preview.classList.remove('hidden');
            }

            createMCQFile() {
                const textarea = document.getElementById('mcq-json-input');
                const value = textarea.value.trim();
                
                if (!value) {
                    alert('Please enter MCQ data first');
                    return;
                }

                try {
                    const mcqs = JSON.parse(value);
                    if (!Array.isArray(mcqs)) {
                        alert('JSON must be an array of MCQs');
                        return;
                    }

                    // Create downloadable file
                    const fileName = `${this.selectedSubject}${this.selectedClass}_ch${this.selectedChapter}_mcqs.json`;
                    const blob = new Blob([JSON.stringify(mcqs, null, 2)], { type: 'application/json' });
                    const url = URL.createObjectURL(blob);
                    
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = fileName;
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    URL.revokeObjectURL(url);

                    this.showSuccessMessage();
                    this.clearForm();
                } catch (error) {
                    alert('Invalid JSON format');
                }
            }

            showSuccessMessage() {
                const message = document.getElementById('success-message');
                message.classList.remove('hidden');
                message.classList.add('success-animation');
                
                setTimeout(() => {
                    message.classList.add('hidden');
                    message.classList.remove('success-animation');
                }, 3000);
            }

            clearForm() {
                document.getElementById('mcq-json-input').value = '';
                document.getElementById('mcq-preview').classList.add('hidden');
                this.hideValidationStatus();
                document.getElementById('create-mcq-file').disabled = true;
            }
        }

        // Initialize the MCQ Manager
        document.addEventListener('DOMContentLoaded', () => {
            new MCQManager();
        });
    </script>
</body>
</html>